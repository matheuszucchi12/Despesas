<script>
document.getElementById("form").addEventListener("submit", function(e) {
    e.preventDefault();

    const data = {
        descricao: document.getElementById("descricao").value,
        categoria: document.getElementById("categoria").value,
        data: document.getElementById("data").value,
        valor: document.getElementById("valor").value
    };

    fetch("https://script.google.com/macros/s/AKfycbxfXDAdeFqlX-hOc-khehkCABKlDsZYlkAmWsgIuJiyzS5-sqvD8kI6SJAWlHHNSTbn5Q/exec", {
        method: "POST",
        body: JSON.stringify(data)
    })
    .then(r => r.json())
    .then(res => {
        if (res.result === "success") {
            alert("Despesa salva com sucesso!");
            document.getElementById("form").reset();
        } else {
            alert("Erro ao salvar: " + res.message);
        }
    })
    .catch(err => {
        alert("Erro de comunicação com o servidor:\n" + err);
    });
});
</script>
